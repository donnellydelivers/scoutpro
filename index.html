<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ScoutPro Radar v2.0</title>

<link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;600;700&family=DM+Mono&display=swap" rel="stylesheet">

<style>
:root{
  --bg:#05060a; --panel:#121728; --card:#171c33; --soft:#222855;
  --border:rgba(255,255,255,.12);
  --text:#f6f7ff; --muted:#9aa3c7;
  --green:#00d68f; --yellow:#ffd166; --red:#ff6b6b; --blue:#5aa9ff;
}
*{box-sizing:border-box}
body{
  margin:0;font-family:'DM Sans',sans-serif;
  background:radial-gradient(circle at top,#0f1430,#05060a 70%);
  color:var(--text);
}
.app{max-width:500px;margin:auto;padding-bottom:40px;}

header{
  position:sticky;top:0;z-index:50;
  background:rgba(7,10,22,.95);
  border-bottom:1px solid var(--border);
  padding:12px;display:flex;gap:8px;
}

input{
  flex:1;padding:12px;border-radius:12px;
  background:#050711;border:1px solid var(--border);
  color:var(--text);font-family:'DM Mono';
}
button{
  padding:0 16px;border:none;border-radius:12px;
  background:var(--blue);font-weight:700;
}

.card{
  margin:14px;background:var(--panel);
  border-radius:24px;border:1px solid var(--border);
  overflow:hidden;
}

/* Decision */
.command{padding:18px;border-bottom:1px solid var(--border);}
.buy{background:linear-gradient(135deg,rgba(0,214,143,.25),#0a0e22)}
.check{background:linear-gradient(135deg,rgba(255,209,102,.25),#0a0e22)}
.pass{background:linear-gradient(135deg,rgba(255,107,107,.25),#0a0e22)}
.action{font-size:26px;font-weight:800}
.sub{font-size:12px;color:var(--muted)}
.kpis{margin-top:12px;display:grid;grid-template-columns:1fr 1fr;gap:10px}
.kpi span{font-size:11px;color:var(--muted)}
.kpi strong{display:block;font-family:'DM Mono';font-size:15px}

.section{padding:14px 18px;border-top:1px solid var(--border)}
.section h4{
  margin:0 0 6px;font-size:11px;
  text-transform:uppercase;letter-spacing:.12em;color:var(--muted)
}
.grid{display:grid;grid-template-columns:1fr 1fr;gap:10px}
.cell{
  background:var(--card);border-radius:12px;
  padding:10px;border:1px solid var(--border)
}
.cell span{font-size:10px;color:var(--muted)}
.cell strong{display:block;margin-top:4px;font-family:'DM Mono'}

.badge{
  display:inline-block;padding:3px 8px;
  font-size:10px;border-radius:999px;font-weight:700
}
.fba{background:rgba(0,214,143,.25);color:var(--green)}
.fbm{background:rgba(255,209,102,.25);color:var(--yellow)}
.amazon{background:rgba(255,107,107,.25);color:var(--red)}
.rotate{background:rgba(90,169,255,.25);color:var(--blue)}
</style>
</head>

<body>
<div class="app">

<header>
  <input
    id="scanInput"
    type="text"
    inputmode="text"
    pattern="[0-9X]*"
    placeholder="Scan ISBN…"
    autocomplete="off"
  >
  <button>GO</button>
</header>

<div class="card">

<div id="banner" class="command buy">
  <div class="action" id="decision">READY</div>
  <div class="sub" id="reason">Waiting for scan</div>
  <div class="kpis">
    <div class="kpi"><span>Median FBA</span><strong id="medianFba">—</strong></div>
    <div class="kpi"><span>Profit</span><strong id="profit">—</strong></div>
    <div class="kpi"><span>ROI</span><strong id="roi">—</strong></div>
    <div class="kpi"><span>Buy Box</span><strong id="bb">—</strong></div>
  </div>
</div>

<div class="section">
<h4>Market Signals</h4>
<div class="grid">
  <div class="cell"><span>Buy Box Type</span><strong id="bbType"></strong></div>
  <div class="cell"><span>Price Stability</span><strong id="stability"></strong></div>
  <div class="cell"><span>Velocity</span><strong id="velocity"></strong></div>
  <div class="cell"><span>False Floor</span><strong id="floor"></strong></div>
</div>
</div>

</div>
</div>

<script>
/* =============================
   CONFIG
============================= */
const BUY_COST = 1.00;
const PROFIT_FLOOR = 5.00;
const SCAN_DELAY = 60; // Nadamoo-safe

/* =============================
   NADAMOO-SAFE SCAN BUFFER
============================= */
const scanInput = document.getElementById("scanInput");
let buffer = "";
let timer = null;

scanInput.focus();

scanInput.addEventListener("input", e => {
  buffer += e.data || "";
  scanInput.value = buffer;

  clearTimeout(timer);
  timer = setTimeout(finalizeScan, SCAN_DELAY);
});

scanInput.addEventListener("keydown", e => {
  if (e.key === "Enter" || e.key === "Tab") {
    e.preventDefault();
    clearTimeout(timer);
    finalizeScan();
  }
});

function finalizeScan(){
  const isbn = buffer.replace(/[^0-9X]/gi,"");
  buffer = "";
  scanInput.value = "";
  scanInput.focus();

  if (isbn.length === 10 || isbn.length === 13) {
    // ✅ HAPTIC FEEDBACK
    if (navigator.vibrate) navigator.vibrate(40);
    processScan(isbn);
  }
}

/* =============================
   MOCK KEEPA DATA
============================= */
function mockKeepa(){
  const bb = ["FBA","FBM","ROTATE","AMAZON"][Math.floor(Math.random()*4)];
  return {
    medianFBA: +(Math.random()*22+14).toFixed(2),
    fbmBB: +(Math.random()*12+9).toFixed(2),
    falseFloor: Math.random()<0.3,
    velocity:["Strong","Moderate","Weak"][Math.floor(Math.random()*3)],
    bbType: bb
  }
}

/* =============================
   CORE DECISION ENGINE
============================= */
function processScan(isbn){
  const d = mockKeepa();
  const sell = d.medianFBA;
  const fees = sell*0.15 + 5;
  const profit = sell - BUY_COST - fees;
  const roi = profit/BUY_COST*100;

  medianFba.textContent = `$${sell}`;
  profit.textContent = `$${profit.toFixed(2)}`;
  roi.textContent = `${roi.toFixed(0)}%`;
  bb.textContent = d.bbType;

  bbType.innerHTML =
    `<span class="badge ${d.bbType==='FBA'?'fba':d.bbType==='FBM'?'fbm':d.bbType==='AMAZON'?'amazon':'rotate'}">${d.bbType}</span>`;

  stability.textContent = d.falseFloor ? "False Floor" : "Stable";
  velocity.textContent = d.velocity;
  floor.textContent = d.falseFloor ? "Detected" : "Clear";

  let cls="check",txt="CHECK",why="Manual review recommended";

  if (d.bbType==="AMAZON"){
    cls="pass";txt="PASS";why="Amazon controls Buy Box";
  }
  else if (profit<=0){
    cls="pass";txt="PASS";why="Not profitable";
  }
  else if (profit>=PROFIT_FLOOR && !d.falseFloor && d.velocity!=="Weak"){
    cls="buy";txt="BUY";why="Healthy FBA margin";
  }

  banner.className = `command ${cls}`;
  decision.textContent = txt;
  reason.textContent = why;
}
</script>

</body>
</html>
