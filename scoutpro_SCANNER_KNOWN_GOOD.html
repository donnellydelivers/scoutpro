<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>ScoutPro – Scanner-Stable Base (KNOWN GOOD)</title>
<style>
body{font-family:system-ui;background:#0a0e1a;color:#fff;margin:0}
header{padding:12px;border-bottom:1px solid #333}
input{width:100%;font-size:16px;padding:14px;background:#141b2d;color:#fff;border:1px solid #333;border-radius:10px}
#log{padding:12px;font-family:monospace;font-size:14px}
</style>
</head>
<body>

<header>
  <input id="scanInput" type="text" placeholder="Scan ISBN">
</header>

<div id="log">Ready</div>

<script>
/*
  ✅ THIS IS THE EXACT SCANNER LOGIC THAT WORKED
  - No cloning
  - No debounce games
  - No duplicate listeners
  - Works with Nadamoo + Android Chrome
*/

const scanInput = document.getElementById('scanInput');
const log = document.getElementById('log');

let buffer = '';
let timer = null;

function processScan(code){
  log.textContent = 'PROCESSED: ' + code;
  scanInput.value = '';
  buffer = '';
}

scanInput.addEventListener('keydown', (e) => {
  if (timer) clearTimeout(timer);

  if (e.key === 'Enter') {
    e.preventDefault();
    if (buffer.length >= 10) processScan(buffer);
    return;
  }

  if (e.key.length === 1) {
    buffer += e.key;
    timer = setTimeout(() => {
      if (buffer.length >= 10) processScan(buffer);
    }, 50);
  }
});

scanInput.focus();
</script>

</body>
</html>
